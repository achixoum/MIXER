       ORIG 0
TBL02      ORIG *+2
TBL11      ORIG *+2
TBL12      ORIG *+1
TBL21      ORIG *+1
TBL31      ORIG *+2
       ORIG 2000

square     STJ EXIT0
           ST1 REC0(0:2)
            ENT1 TBL21
           LDA 0,1
           STA TEMP0
           LDA 0,1
           MUL TEMP0
           SLAX 5
          JMP REC0
REC0      ENT1 *
EXIT0     JMP *

hypSqrd     STJ EXIT1
           ST1 REC1(0:2)
            ENT1 TBL31
           ENT3 TBL21
           LDA 1,1
           STA 0,3
           JMP square
           STA TEMP1
           ENT3 TBL21
           LDA 0,1
           STA 0,3
           JMP square
           ADD TEMP1
          JMP REC1
REC1      ENT1 *
EXIT1     JMP *

perimeter     STJ EXIT2
           ST1 REC2(0:2)
            ENT1 TBL11
           ST2 REC3(0:2)
            ENT2 TBL12
           ENT3 TBL31
           LDA 0,1
           STA 0,3
           LDA 1,1
           STA 1,3
           JMP hypSqrd
           STA 0,2
           LDA 0,2
           STA TEMP2
           LDA 1,1
           STA TEMP3
           LDA 0,1
           ADD TEMP3
           ADD TEMP2
          JMP REC2
REC2      ENT1 *
REC3      ENT2 *
EXIT2     JMP *

main     STJ EXIT3
           ST2 REC4(0:2)
            ENT2 TBL02
           ENT3 TBL31
           LDA =1=
           STA TEMP4
           LDA =3=
           ADD TEMP4
           STA 0,3
           LDA =2=
           STA TEMP5
           LDA =2=
           MUL TEMP5
           SLAX 5
           STA 1,3
           JMP hypSqrd
           STA 0,2
           ENT3 TBL11
           LDA =3=
           STA 0,3
           LDA =4=
           STA 1,3
           JMP perimeter
           STA 1,2
           LDA 1,2
           STA TEMP6
           LDA 0,2
           ADD TEMP6
          JMP REC4
REC4      ENT2 *
EXIT3     JMP *
       HLT
       END MAIN
